position = position_dodge(width=1), size = 2.5) +
guides(fill = guide_legend(reverse = TRUE)) +
scale_y_continuous(breaks = c(25, 50, 75, 100), limits = c(0, 120))
Fig2A
Fig2A <- ggplot(worms) +
geom_bar(stat = "identity", aes(x = factor(fixed_substrate), y = perc_worm_sub, fill = plot_type), colour = "black") +
scale_fill_manual(values=c(allPalette))+
coord_flip() +
theme(panel.border = element_blank(),
axis.line = element_line(colour = "black"),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title = element_text(size = 10, color = "black"),
axis.text = element_text(size = 10, color = "black"),
legend.text = element_text(size = 10, color = "black")) +
labs(fill = "", x = "", y = "Percentage of all collections") +
geom_text(aes(x=fixed_substrate, y=113, label=paste0("n=", total_substrates)),
position = position_dodge(width=1), size = 2.5) +
guides(fill = guide_legend(reverse = TRUE)) +
scale_y_continuous(breaks = c(25, 50, 75, 100), limits = c(0, 120))
Fig2A
Fig2B_v2 <- ggplot(data = newdf_2) +
geom_bar(stat = "identity", position = "dodge", aes(x = factor(fixed_substrate), y = perc_worm_sub2, fill = species_family), colour = "black") +
scale_fill_manual(values=c(species_palette)) +
coord_flip() +
theme(panel.border = element_blank(),
axis.line = element_line(colour = "black"),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title = element_text(size = 10, color = "black"),
axis.text = element_text(size = 10, color = "black"),
legend.text = element_text(size = 10, color = "black")) +
labs(fill = "", x = "", y = "Percentage of all collections") +
guides(fill = guide_legend(reverse = T)) +
scale_y_continuous(breaks = c(2.5, 5.0, 7.5, 10), limits = c(0, 10.5))
figure2AB <- cowplot::plot_grid(Fig2A, Fig2B_v2, labels = c("A","B"), ncol=1, align = "v")
figure2AB
Figure_2 <- cowplot::plot_grid(figure2AB, figure2C, labels = c("","C"), rel_widths = c(1, .6067))
Figure_2
ggsave('plots/Figure2_REVISED_v2.pdf', plot = Figure_2, height = 5, width = 7.5)
chi_sub_test <- worms %>%
dplyr::filter(plot_type == "Caenorhabditis") %>%
dplyr::mutate(no_c = total_substrates-worm_per_substrate,
c = worm_per_substrate) %>%
dplyr::select(fixed_substrate, no_c, c) %>%
column_to_rownames(var = "fixed_substrate") %>%
as.matrix(.)
options(scipen=999)
chisq.test(chi_sub_test, simulate.p.value = TRUE)
pairwiseNominalIndependence(chi_sub_test,
fisher = TRUE,
gtest  = FALSE,
chisq  = FALSE,
method = "bonferroni", simulate.p.value = TRUE)
FE_test_ce <- newdf %>%
dplyr::filter(species_family == "C. elegans") %>%
dplyr::mutate(tot_sub = case_when(
fixed_substrate == "Leaf litter" ~ 1483,
fixed_substrate == "Fruit/nut/veg" ~ 327,
fixed_substrate == "Flower" ~ 202,
fixed_substrate == "Fungus" ~ 122,
fixed_substrate == "Vegerable" ~ 83),
no_ce = tot_sub-worm_per_substrate,
ce = worm_per_substrate) %>%
dplyr::select(fixed_substrate, no_ce, ce) %>%
column_to_rownames(var = "fixed_substrate") %>%
as.matrix(.)
FE_test_ce <- newdf %>%
dplyr::filter(species_family == "C. elegans") %>%
dplyr::mutate(tot_sub = case_when(
fixed_substrate == "Leaf litter" ~ 1483,
fixed_substrate == "Fruit/nut/veg" ~ 327,
fixed_substrate == "Flower" ~ 202,
fixed_substrate == "Fungus" ~ 122,
fixed_substrate == "Vegerable" ~ 83),
no_ce = tot_sub-worm_per_substrate,
ce = worm_per_substrate) %>%
dplyr::select(fixed_substrate, no_ce, ce) %>%
column_to_rownames(var = "fixed_substrate") %>%
as.matrix(.)
FE_test_co <- newdf %>%
dplyr::filter(species_family == "C. oiwi") %>%
dplyr::mutate(tot_sub = case_when(
fixed_substrate == "Leaf litter" ~ 1483,
fixed_substrate == "Fruit/nut/veg" ~ 327,
fixed_substrate == "Flower" ~ 202,
fixed_substrate == "Fungus" ~ 122,
fixed_substrate == "Vegerable" ~ 83),
no_co = tot_sub-worm_per_substrate,
co = worm_per_substrate) %>%
dplyr::select(fixed_substrate, no_co, co) %>%
column_to_rownames(var = "fixed_substrate") %>%
as.matrix(.)
FE_test_ct <- newdf %>%
dplyr::filter(species_family == "C. tropicalis") %>%
dplyr::mutate(tot_sub = case_when(
fixed_substrate == "Leaf litter" ~ 1483,
fixed_substrate == "Fruit/nut/veg" ~ 327,
fixed_substrate == "Flower" ~ 202,
fixed_substrate == "Fungus" ~ 122,
fixed_substrate == "Vegerable" ~ 83),
no_ct = tot_sub-worm_per_substrate,
ct = worm_per_substrate) %>%
dplyr::select(fixed_substrate, no_ct, ct) %>%
column_to_rownames(var = "fixed_substrate") %>%
as.matrix(.)
FE_test_cb <- newdf %>%
dplyr::filter(species_family == "C. briggsae") %>%
dplyr::mutate(tot_sub = case_when(
fixed_substrate == "Leaf litter" ~ 1483,
fixed_substrate == "Fruit/nut/veg" ~ 327,
fixed_substrate == "Flower" ~ 202,
fixed_substrate == "Fungus" ~ 122,
fixed_substrate == "Vegerable" ~ 83),
no_cb = tot_sub-worm_per_substrate,
cb = worm_per_substrate) %>%
dplyr::select(fixed_substrate, no_cb, cb) %>%
column_to_rownames(var = "fixed_substrate") %>%
as.matrix(.)
pairwiseNominalIndependence(FE_test_ce,
fisher = TRUE,
gtest  = FALSE,
chisq  = FALSE,
method = "bonferroni", simulate.p.value = TRUE)
FE_test_ce <- newdf %>%
dplyr::filter(species_family == "C. elegans") %>%
dplyr::mutate(tot_sub = case_when(
fixed_substrate == "Leaf litter" ~ 1483,
fixed_substrate == "Fruit" ~ 327,
fixed_substrate == "Flower" ~ 202,
fixed_substrate == "Fungus" ~ 122,
fixed_substrate == "Vegetable" ~ 83),
no_ce = tot_sub-worm_per_substrate,
ce = worm_per_substrate) %>%
dplyr::select(fixed_substrate, no_ce, ce) %>%
column_to_rownames(var = "fixed_substrate") %>%
as.matrix(.)
FE_test_co <- newdf %>%
dplyr::filter(species_family == "C. oiwi") %>%
dplyr::mutate(tot_sub = case_when(
fixed_substrate == "Leaf litter" ~ 1483,
fixed_substrate == "Fruit" ~ 327,
fixed_substrate == "Flower" ~ 202,
fixed_substrate == "Fungus" ~ 122,
fixed_substrate == "Vegetable" ~ 83),
no_co = tot_sub-worm_per_substrate,
co = worm_per_substrate) %>%
dplyr::select(fixed_substrate, no_co, co) %>%
column_to_rownames(var = "fixed_substrate") %>%
as.matrix(.)
FE_test_ct <- newdf %>%
dplyr::filter(species_family == "C. tropicalis") %>%
dplyr::mutate(tot_sub = case_when(
fixed_substrate == "Leaf litter" ~ 1483,
fixed_substrate == "Fruit" ~ 327,
fixed_substrate == "Flower" ~ 202,
fixed_substrate == "Fungus" ~ 122,
fixed_substrate == "Vegetable" ~ 83),
no_ct = tot_sub-worm_per_substrate,
ct = worm_per_substrate) %>%
dplyr::select(fixed_substrate, no_ct, ct) %>%
column_to_rownames(var = "fixed_substrate") %>%
as.matrix(.)
FE_test_cb <- newdf %>%
dplyr::filter(species_family == "C. briggsae") %>%
dplyr::mutate(tot_sub = case_when(
fixed_substrate == "Leaf litter" ~ 1483,
fixed_substrate == "Fruit" ~ 327,
fixed_substrate == "Flower" ~ 202,
fixed_substrate == "Fungus" ~ 122,
fixed_substrate == "Vegetable" ~ 83),
no_cb = tot_sub-worm_per_substrate,
cb = worm_per_substrate) %>%
dplyr::select(fixed_substrate, no_cb, cb) %>%
column_to_rownames(var = "fixed_substrate") %>%
as.matrix(.)
pairwiseNominalIndependence(FE_test_ce,
fisher = TRUE,
gtest  = FALSE,
chisq  = FALSE,
method = "bonferroni", simulate.p.value = TRUE)
pairwiseNominalIndependence(FE_test_co,
fisher = TRUE,
gtest  = FALSE,
chisq  = FALSE,
method = "bonferroni", simulate.p.value = TRUE)
pairwiseNominalIndependence(FE_test_ct,
fisher = TRUE,
gtest  = FALSE,
chisq  = FALSE,
method = "bonferroni", simulate.p.value = TRUE)
pairwiseNominalIndependence(FE_test_cb,
fisher = TRUE,
gtest  = FALSE,
chisq  = FALSE,
method = "bonferroni", simulate.p.value = TRUE)
cor_test_df <- data1 %>%
dplyr::filter(species_id %in% c("C. elegans", "C. tropicalis", "C. briggsae",  "C. oiwi"))  %>%
dplyr::distinct(c_label, species_id, .keep_all = T) %>%
dplyr::select(species_id, fixed_substrate, approximate_number_of_worms) %>%
dplyr::mutate(fixed_substrate = factor(fixed_substrate, levels = c("Leaf litter", "Flower", "Fruit", "Fungus",  "Vegetable")),
fixed_substrate1 = as.numeric(fixed_substrate),
approx_pop = factor(approximate_number_of_worms, levels = c("Very Few (1-3)", "Few (4-10)", "Some (11-25)", "Proliferating (25+)")),
approx_pop1 = as.numeric(approx_pop),
approx_pop2 = ifelse(approximate_number_of_worms == "Proliferating (25+)", 2,1))
cor_test_df_flvsll_test <- cor_test_df %>%
dplyr::filter(fixed_substrate %in% c("Flower", "Leaf litter")) %>%
dplyr::group_by(species_id) %>%
dplyr::do(broom::tidy(cor.test(.$fixed_substrate1, .$approx_pop2, alternative = "g")))
cor_test_df_flvsll_test
cor_test_df_fnvvsfl_test <- cor_test_df %>%
dplyr::mutate(fixed_substrate = factor(fixed_substrate, levels = c("Fruit", "Flower", "Leaf litter", "Fungus",  "Vegetable")), # reorder for cor test between fruit and flower
fixed_substrate1 = as.numeric(fixed_substrate)) %>%
dplyr::filter(fixed_substrate %in% c("Fruit", "Flower"))%>%
dplyr::group_by(species_id) %>%
dplyr::do(broom::tidy(cor.test(.$fixed_substrate1, .$approx_pop2, alternative = "g")))
cor_test_df_fnvvsfl_test
View(newdf)
View(worms)
isolation_success <- worms %>%
dplyr::filter(!(plot_type %in% c("Tracks only", "No nematode"))) %>%
dplyr::group_by(fixed_substrate) %>%
dplyr::mutate(suc_rate = sum(perc_worm_sub))
View(isolation_success)
pairwiseNominalIndependence(FE_test_cb,
fisher = TRUE,
gtest  = FALSE,
chisq  = FALSE,
method = "bonferroni", simulate.p.value = TRUE)
FE_test_cb
pairwiseNominalIndependence(FE_test_ct,
fisher = TRUE,
gtest  = FALSE,
chisq  = FALSE,
method = "bonferroni", simulate.p.value = TRUE)
FE_test_ct <- newdf %>%
dplyr::filter(species_family == "C. tropicalis") %>%
dplyr::mutate(tot_sub = case_when(
fixed_substrate == "Leaf litter" ~ 1483,
fixed_substrate == "Fruit" ~ 327,
fixed_substrate == "Flower" ~ 202,
fixed_substrate == "Fungus" ~ 122,
fixed_substrate == "Vegetable" ~ 83),
no_ct = tot_sub-worm_per_substrate,
ct = worm_per_substrate) %>%
dplyr::select(fixed_substrate, no_ct, ct) %>%
column_to_rownames(var = "fixed_substrate") %>%
as.matrix(.)
FE_test_ct
FE_test_ce <- newdf %>%
dplyr::filter(species_family == "C. elegans") %>%
dplyr::mutate(tot_sub = case_when(
fixed_substrate == "Leaf litter" ~ 1493,
fixed_substrate == "Fruit" ~ 327,
fixed_substrate == "Flower" ~ 202,
fixed_substrate == "Fungus" ~ 122,
fixed_substrate == "Vegetable" ~ 83),
no_ce = tot_sub-worm_per_substrate,
ce = worm_per_substrate) %>%
dplyr::select(fixed_substrate, no_ce, ce) %>%
column_to_rownames(var = "fixed_substrate") %>%
as.matrix(.)
FE_test_co <- newdf %>%
dplyr::filter(species_family == "C. oiwi") %>%
dplyr::mutate(tot_sub = case_when(
fixed_substrate == "Leaf litter" ~ 1493,
fixed_substrate == "Fruit" ~ 327,
fixed_substrate == "Flower" ~ 202,
fixed_substrate == "Fungus" ~ 122,
fixed_substrate == "Vegetable" ~ 83),
no_co = tot_sub-worm_per_substrate,
co = worm_per_substrate) %>%
dplyr::select(fixed_substrate, no_co, co) %>%
column_to_rownames(var = "fixed_substrate") %>%
as.matrix(.)
FE_test_ct <- newdf %>%
dplyr::filter(species_family == "C. tropicalis") %>%
dplyr::mutate(tot_sub = case_when(
fixed_substrate == "Leaf litter" ~ 1493,
fixed_substrate == "Fruit" ~ 327,
fixed_substrate == "Flower" ~ 202,
fixed_substrate == "Fungus" ~ 122,
fixed_substrate == "Vegetable" ~ 83),
no_ct = tot_sub-worm_per_substrate,
ct = worm_per_substrate) %>%
dplyr::select(fixed_substrate, no_ct, ct) %>%
column_to_rownames(var = "fixed_substrate") %>%
as.matrix(.)
FE_test_cb <- newdf %>%
dplyr::filter(species_family == "C. briggsae") %>%
dplyr::mutate(tot_sub = case_when(
fixed_substrate == "Leaf litter" ~ 1493,
fixed_substrate == "Fruit" ~ 327,
fixed_substrate == "Flower" ~ 202,
fixed_substrate == "Fungus" ~ 122,
fixed_substrate == "Vegetable" ~ 83),
no_cb = tot_sub-worm_per_substrate,
cb = worm_per_substrate) %>%
dplyr::select(fixed_substrate, no_cb, cb) %>%
column_to_rownames(var = "fixed_substrate") %>%
as.matrix(.)
pairwiseNominalIndependence(chi_sub_test,
fisher = TRUE,
gtest  = FALSE,
chisq  = FALSE,
method = "bonferroni", simulate.p.value = TRUE)
chi_sub_test
FE_test_ce <- newdf %>%
dplyr::filter(species_family == "C. elegans") %>%
dplyr::mutate(tot_sub = case_when(
fixed_substrate == "Leaf litter" ~ 1493,
fixed_substrate == "Fruit" ~ 327,
fixed_substrate == "Flower" ~ 202,
fixed_substrate == "Fungus" ~ 122,
fixed_substrate == "Vegetable" ~ 83),
no_ce = tot_sub-worm_per_substrate,
ce = worm_per_substrate) %>%
dplyr::select(fixed_substrate, no_ce, ce) %>%
column_to_rownames(var = "fixed_substrate") %>%
as.matrix(.)
FE_test_co <- newdf %>%
dplyr::filter(species_family == "C. oiwi") %>%
dplyr::mutate(tot_sub = case_when(
fixed_substrate == "Leaf litter" ~ 1493,
fixed_substrate == "Fruit" ~ 327,
fixed_substrate == "Flower" ~ 202,
fixed_substrate == "Fungus" ~ 122,
fixed_substrate == "Vegetable" ~ 83),
no_co = tot_sub-worm_per_substrate,
co = worm_per_substrate) %>%
dplyr::select(fixed_substrate, no_co, co) %>%
column_to_rownames(var = "fixed_substrate") %>%
as.matrix(.)
FE_test_ct <- newdf %>%
dplyr::filter(species_family == "C. tropicalis") %>%
dplyr::mutate(tot_sub = case_when(
fixed_substrate == "Leaf litter" ~ 1493,
fixed_substrate == "Fruit" ~ 327,
fixed_substrate == "Flower" ~ 202,
fixed_substrate == "Fungus" ~ 122,
fixed_substrate == "Vegetable" ~ 83),
no_ct = tot_sub-worm_per_substrate,
ct = worm_per_substrate) %>%
dplyr::select(fixed_substrate, no_ct, ct) %>%
column_to_rownames(var = "fixed_substrate") %>%
as.matrix(.)
FE_test_cb <- newdf %>%
dplyr::filter(species_family == "C. briggsae") %>%
dplyr::mutate(tot_sub = case_when(
fixed_substrate == "Leaf litter" ~ 1493,
fixed_substrate == "Fruit" ~ 327,
fixed_substrate == "Flower" ~ 202,
fixed_substrate == "Fungus" ~ 122,
fixed_substrate == "Vegetable" ~ 83),
no_cb = tot_sub-worm_per_substrate,
cb = worm_per_substrate) %>%
dplyr::select(fixed_substrate, no_cb, cb) %>%
column_to_rownames(var = "fixed_substrate") %>%
as.matrix(.)
pairwiseNominalIndependence(FE_test_ce,
fisher = TRUE,
gtest  = FALSE,
chisq  = FALSE,
method = "bonferroni", simulate.p.value = TRUE)
pairwiseNominalIndependence(FE_test_co,
fisher = TRUE,
gtest  = FALSE,
chisq  = FALSE,
method = "bonferroni", simulate.p.value = TRUE)
pairwiseNominalIndependence(FE_test_ct,
fisher = TRUE,
gtest  = FALSE,
chisq  = FALSE,
method = "bonferroni", simulate.p.value = TRUE)
pairwiseNominalIndependence(FE_test_cb,
fisher = TRUE,
gtest  = FALSE,
chisq  = FALSE,
method = "bonferroni", simulate.p.value = TRUE)
FE_test_cb
pairwiseNominalIndependence(FE_test_ct,
fisher = TRUE,
gtest  = FALSE,
chisq  = FALSE,
method = "bonferroni", simulate.p.value = TRUE)
pairwiseNominalIndependence(FE_test_ce,
fisher = TRUE,
gtest  = FALSE,
chisq  = FALSE,
method = "bonferroni", simulate.p.value = TRUE)
pairwiseNominalIndependence(FE_test_co,
fisher = TRUE,
gtest  = FALSE,
chisq  = FALSE,
method = "bonferroni", simulate.p.value = TRUE)
FE_test_co
cor_test_df <- data1 %>%
dplyr::filter(species_id %in% c("C. elegans", "C. tropicalis", "C. briggsae",  "C. oiwi"))  %>%
dplyr::distinct(c_label, species_id, .keep_all = T) %>%
dplyr::select(species_id, fixed_substrate, approximate_number_of_worms) %>%
dplyr::mutate(fixed_substrate = factor(fixed_substrate, levels = c("Leaf litter", "Flower", "Fruit", "Fungus",  "Vegetable")),
fixed_substrate1 = as.numeric(fixed_substrate),
approx_pop = factor(approximate_number_of_worms, levels = c("Very Few (1-3)", "Few (4-10)", "Some (11-25)", "Proliferating (25+)")),
approx_pop1 = as.numeric(approx_pop),
approx_pop2 = ifelse(approximate_number_of_worms == "Proliferating (25+)", 2,1))
cor_test_df_flvsll_test <- cor_test_df %>%
dplyr::filter(fixed_substrate %in% c("Flower", "Leaf litter")) %>%
dplyr::group_by(species_id) %>%
dplyr::do(broom::tidy(cor.test(.$fixed_substrate1, .$approx_pop2, alternative = "g")))
cor_test_df_flvsll_test
cor_test_df_fnvvsfl_test <- cor_test_df %>%
dplyr::mutate(fixed_substrate = factor(fixed_substrate, levels = c("Fruit", "Flower", "Leaf litter", "Fungus",  "Vegetable")), # reorder for cor test between fruit and flower
fixed_substrate1 = as.numeric(fixed_substrate)) %>%
dplyr::filter(fixed_substrate %in% c("Fruit", "Flower"))%>%
dplyr::group_by(species_id) %>%
dplyr::do(broom::tidy(cor.test(.$fixed_substrate1, .$approx_pop2, alternative = "g")))
cor_test_df_fnvvsfl_test
worms %>%
readr::write_csv('data/elife_files/fig2-data1.csv')
newdf_2 %>%
readr::write_csv('data/elife_files/fig2-data2.csv')
library(tidyverse)
library(grid)
library(gridExtra)
library(imager)
library(jpeg)
library(pals)
library(rcompanion)
setwd(glue::glue("{dirname(rstudioapi::getActiveDocumentContext()$path)}/.."))
data1 <- data.table::fread("data/Supplemental Data 1.tsv")
species_palette <- c("C. elegans" = "#BE0032", #7
"C. oiwi" =  "#875692", #4
"C. tropicalis" = "#F38400", #5
"Panagrolaimus sp." = "#C2B280", #8
"Oscheius sp." = "#F3C300", #3
"C. briggsae" = "#A1CAF1", #6
"Other PCR +" = "#008856", #10
"Caenorhabditis" = "#C2B280", #8
"PCR -" = "#848482", #9
"Not genotyped" = "#F2F3F4", #1
"No nematode" = "#222222", #2
"multiple" = "#FFFFFF")
substrate_palette <- c("Leaf litter" = "#E68FAC",
"Fruit" = "#0067A5",
"Flower" = "#DCD300",
"Fungus" = "#604E97",
"Compost" = "#F6A600",
"Vegetable" = "#B3446C")
allPalette <- c("Caenorhabditis" = "#C2B280",
"Other PCR +" = "#008856",
"PCR -" = "#848482",
"Not genotyped" = "#F2F3F4",
"Tracks only" = "#b3b3b3",
"No nematode" ="#222222")
rh_positive_c_labels <- data1 %>%
dplyr::filter(pcr_positive == 1) %>%
dplyr::distinct(c_label)
worms <- data1 %>%
#dplyr::filter(worms_on_sample != "?") %>% # originally we filtered out ? c-labels but now we are assigning them to No Nematodes
dplyr::mutate(plot_type = ifelse(worms_on_sample %in% c("?","No"), "No nematode",
ifelse(worms_on_sample == "Tracks", "Tracks only",
ifelse((worms_on_sample == "Yes" & is.na(pcr_positive) | (pcr_positive == 1 & species_id == "Unknown")), "Not genotyped",
ifelse(worms_on_sample == "Yes" & pcr_positive == 0, "PCR -",
ifelse(worms_on_sample == "Yes" & pcr_positive == 1 & !(species_id %in% c("C. elegans",
"C. briggsae",
"C. oiwi",
"C. tropicalis",
"C. kamaaina")), "Other PCR +", "Caenorhabditis")))))) %>%
dplyr::mutate(plot_type = factor(plot_type, levels = c("Caenorhabditis",
"Other PCR +",
"PCR -",
"Not genotyped",
"Tracks only",
"No nematode"))) %>%
dplyr::arrange(plot_type) %>%
dplyr::distinct(c_label, .keep_all = TRUE) %>%
dplyr::group_by(plot_type, fixed_substrate) %>%
dplyr::mutate(worm_per_substrate = n()) %>%
dplyr::distinct(plot_type, fixed_substrate, .keep_all = T) %>%
dplyr::ungroup() %>%
dplyr::group_by(fixed_substrate) %>%
dplyr::mutate(total_substrates = sum(worm_per_substrate), perc_worm_sub = worm_per_substrate / total_substrates * 100) %>%
dplyr::arrange(total_substrates) %>%
dplyr::select(fixed_substrate, worm_per_substrate, total_substrates, perc_worm_sub, plot_type) %>%
dplyr::ungroup() %>%
dplyr::mutate(plot_type = factor(plot_type, levels = rev(names(allPalette)))) %>%
dplyr::mutate(fixed_substrate = factor(fixed_substrate, levels = rev(c("Leaf litter","Fruit", "Flower", "Fungus",
"Vegetable", "Invertebrate"))))
View(worms)
worms <- data1 %>%
#dplyr::filter(worms_on_sample != "?") %>% # originally we filtered out ? c-labels but now we are assigning them to No Nematodes
dplyr::mutate(plot_type = ifelse(worms_on_sample %in% c("?","No"), "No nematode",
ifelse(worms_on_sample == "Tracks", "Tracks only",
ifelse((worms_on_sample == "Yes" & is.na(pcr_positive) | (pcr_positive == 1 & species_id == "Unknown")), "Not genotyped",
ifelse(worms_on_sample == "Yes" & pcr_positive == 0, "PCR -",
ifelse(worms_on_sample == "Yes" & pcr_positive == 1 & !(species_id %in% c("C. elegans",
"C. briggsae",
"C. oiwi",
"C. tropicalis",
"C. kamaaina")), "Other PCR +", "Caenorhabditis")))))) %>%
dplyr::mutate(plot_type = factor(plot_type, levels = c("Caenorhabditis",
"Other PCR +",
"PCR -",
"Not genotyped",
"Tracks only",
"No nematode"))) %>%
dplyr::arrange(plot_type) %>%
dplyr::distinct(c_label, .keep_all = TRUE)
View(worms)
View(data1)
